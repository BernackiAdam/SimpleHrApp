<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>List of employees</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script th:src="@{/js/toggleSearchEmployee.js}"></script>
    <style>
        a{
            text-decoration: none;
        }
        .sort-arrow {
            visibility: hidden;
            text-decoration: none;
            color:white;
        }

        th:hover .sort-arrow {
            visibility: visible;
        }
    </style>

</head>
<body>
<div th:insert="~{fragments/general.html :: navbar}"></div>

<div class="container">
    <h3>List of employees</h3>
    <form th:action="@{/employee/list}" method="get">
        <div class="d-flex form-group mb-3 justify-content-between align-items-end">
            <div class="d-flex">
                <div id="searchByField" class="me-3">
                    <label class="form-label">Search by:</label>
                    <select class="form-select" name="searchBy" id="searchBy" onchange="toggleSearchEmployee()">
                        <option selected="selected" value=""  hidden disabled>Select option</option>
                        <option th:each="option : ${searchByList}"
                                th:value="${option}"
                                th:text="${option}"
                                th:selected="${option} == ${searchBy}"></option>
                    </select>
                </div>
                <div id="fullNameField" class="mb-3" style="display: none;">
                    <div class="mx-3">
                        <label class="form-label">Enter first name</label>
                        <input type="text" name="searchByFirstName" class="form-control"
                               th:value="${searchParams['searchByFirstName']}">
                    </div>
                    <div>
                        <label class="form-label">Enter last name</label>
                        <input type="text" name="searchByLastName" class="form-control"
                               th:value="${searchParams['searchByLastName']}">
                    </div>
                </div>
                <div id="emailField" class="mx-3"  style="display: none;">
                    <label class="form-label">Enter email</label>
                    <input type="text" name="searchByEmail" class="form-control"
                       th:value="${searchParams['searchByEmail']}">
                </div>
                <div id="telephoneNumberField" class="mx-3"  style="display: none;">
                    <label class="form-label">Enter telephone number</label>
                    <input type="text" name="searchByTelNr" class="form-control"
                        th:value="${searchParams['searchByTelNr']}">
                </div>
                <div id="seniorityField" class="mx-3"  style="display: none;">
                    <label class="form-label">Choose seniority</label>
                    <select name="searchBySeniority" class="form-select">
                        <option selected="selected" value="" hidden disabled>Select option</option>
                        <option th:each="seniority : ${seniorityList}"
                                th:value="${seniority}" th:text="${seniority}"
                                th:selected="${seniority} == ${searchParams['searchBySeniority']}"></option>
                    </select>

                </div>
                <div id="positionField" class="mx-3 column"  style="display: none;">
                    <label class="form-label">Choose position</label>
                    <select name="searchByPosition" class="form-select">
                        <option selected="selected" value="" hidden disabled>Select option</option>
                        <option th:each="position : ${positionList}"
                                th:value="${position}" th:text="${position}"
                                th:selected="${position} == ${searchParams['searchByPosition']}"></option>
                    </select>
                </div>
                <div id="fullPositionField" class="mx-3" style="display: none;">
                    <div class="me-3">
                        <label class="form-label">Choose seniority</label>
                        <select name="searchBySeniority" class="form-select">
                            <option selected="selected" value="" hidden disabled>Select option</option>
                            <option th:each="seniority : ${seniorityList}"
                                    th:value="${seniority}" th:text="${seniority}"
                                    th:selected="${seniority} == ${searchParams['searchBySeniority']}"></option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">Choose position</label>
                        <select name="searchByPosition" class="form-select">
                            <option selected="selected" value="" hidden disabled>Select option</option>
                            <option th:each="position : ${positionList}"
                                    th:value="${position}" th:text="${position}"
                                    th:selected="${position} == ${searchParams['searchByPosition']}"></option>
                        </select>
                    </div>

                </div>
            </div>

            <div class="d-flex">
                <button type="submit" class="btn btn-primary mb-3 ms-3 me-3">Search</button>
                <div th:if="${!searchBy.isEmpty()}">
                    <a th:href="@{/employee/list}" class="btn btn-warning">Clear</a>
                </div>
            </div>
        </div>
    </form>
    <table class="table table-bordered table-striped">
        <thead class="table-dark">
        <tr>
            <th>
                Id
                <a th:href="@{/employee/list(sortBy='id', sortDirection=${sortDirection == 'asc'? 'desc' : 'asc'}, page=${page},searchBy=${searchBy},
                        searchByFirstName=${searchParams['searchByFirstName']},
                        searchByLastName=${searchParams['searchByLastName']},
                        searchByEmail=${searchParams['searchByEmail']},
                        searchByTelNr=${searchParams['searchByTelNr']},
                        searchBySeniority=${searchParams['searchBySeniority']},
                        searchByPosition=${searchParams['searchByPosition']})}">
                    <span th:text="${sortDirection=='asc'? '▲' : '▼'}" class="sort-arrow"></span>
                </a>
            </th>
            <th>
                First Name
                <a th:href="@{/employee/list(sortBy='firstName', sortDirection=${sortDirection == 'asc'? 'desc' : 'asc'}, page=${page}, searchBy=${searchBy},
                        searchByFirstName=${searchParams['searchByFirstName']},
                        searchByLastName=${searchParams['searchByLastName']},
                        searchByEmail=${searchParams['searchByEmail']},
                        searchByTelNr=${searchParams['searchByTelNr']},
                        searchBySeniority=${searchParams['searchBySeniority']},
                        searchByPosition=${searchParams['searchByPosition']})}">
                    <span class="sort-arrow" th:text="${sortDirection=='asc'? '▲' : '▼'}"></span>
                </a>
            </th>
            <th>
                Last Name
                <a th:href="@{/employee/list(sortBy='lastName', sortDirection=${sortDirection == 'asc'? 'desc' : 'asc'}, page=${page},searchBy=${searchBy},
                        searchByFirstName=${searchParams['searchByFirstName']},
                        searchByLastName=${searchParams['searchByLastName']},
                        searchByEmail=${searchParams['searchByEmail']},
                        searchByTelNr=${searchParams['searchByTelNr']},
                        searchBySeniority=${searchParams['searchBySeniority']},
                        searchByPosition=${searchParams['searchByPosition']})}">
                    <span class="sort-arrow" th:text="${sortDirection=='asc'? '▲' : '▼'}"></span>
                </a>
            </th>
            <th>
                Email
                <a th:href="@{/employee/list(sortBy='email', sortDirection=${sortDirection == 'asc'? 'desc' : 'asc'}, page=${page},searchBy=${searchBy},
                        searchByFirstName=${searchParams['searchByFirstName']},
                        searchByLastName=${searchParams['searchByLastName']},
                        searchByEmail=${searchParams['searchByEmail']},
                        searchByTelNr=${searchParams['searchByTelNr']},
                        searchBySeniority=${searchParams['searchBySeniority']},
                        searchByPosition=${searchParams['searchByPosition']})}">
                    <span class="sort-arrow" th:text="${sortDirection=='asc'? '▲' : '▼'}"></span>
                </a>
            </th>
            <th>
                Telephone number
                <a th:href="@{/employee/list(sortBy='telephoneNumber', sortDirection=${sortDirection == 'asc'? 'desc' : 'asc'}, page=${page}, searchBy=${searchBy},
                        searchByFirstName=${searchParams['searchByFirstName']},
                        searchByLastName=${searchParams['searchByLastName']},
                        searchByEmail=${searchParams['searchByEmail']},
                        searchByTelNr=${searchParams['searchByTelNr']},
                        searchBySeniority=${searchParams['searchBySeniority']},
                        searchByPosition=${searchParams['searchByPosition']})}">
                    <span class="sort-arrow" th:text="${sortDirection=='asc'? '▲' : '▼'}"></span>
                </a>
            </th>
            <th>
                Position
                <a th:href="@{/employee/list(sortBy='seniority', sortDirection=${sortDirection == 'asc'? 'desc' : 'asc'}, page=${page},searchBy=${searchBy},
                        searchByFirstName=${searchParams['searchByFirstName']},
                        searchByLastName=${searchParams['searchByLastName']},
                        searchByEmail=${searchParams['searchByEmail']},
                        searchByTelNr=${searchParams['searchByTelNr']},
                        searchBySeniority=${searchParams['searchBySeniority']},
                        searchByPosition=${searchParams['searchByPosition']})}">
                    <span class="sort-arrow" th:text="${sortDirection=='asc'? '▲' : '▼'}"></span>
                </a>
            </th>
            <th>
                Action
            </th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="emp : ${employeePage.content}" >
            <th th:text="${emp.id}" ></th>
            <td th:text="${emp.firstName}"></td>
            <td th:text="${emp.lastName}"></td>
            <td th:text="${emp.email}"></td>
            <td th:text="${emp.telephoneNumber}"></td>
            <td th:text="${emp.seniority + ' ' + emp.position}"></td>
            <td>
                <a th:href="@{/employee/info(employeeId = ${emp.id})}"
                   class="btn btn-info">Info</a>
            </td>
        </tr>
        </tbody>

    </table>
    <div th:if="${totalPages>1}"
         th:insert="~{fragments/content.html
        :: paginationWithSelectForEmployeeList (totalPages=${totalPages}, currentPage=${currentPage}, pageNumbers=${pageNumbers}, endpoint='/employee/list', searchBy=${searchBy}, searchParams=${searchParams})}"></div>
</div>
</body>
</html>